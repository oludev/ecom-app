{{> mainHeader}}
{{> navbar}}

<h2 class="myacct">Home / My Account / Profile</h2>
<hr>
<section>
	<div class="container profile-form my-5">
		<div class="row p-2">
						<!-- LEFT CARD -->
			<div class="col-lg-4 col-md-5 col-sm-12" style="margin-bottom: 20px;">
			<div class="card" id="profile-card">
				<div class="card-body text-center">
				<!-- Dummy profile image -->
				<img
					src="https://api.dicebear.com/8.x/bottts/svg?seed={{user.username}}"
					alt="Profile Picture"
					class="rounded-circle mb-3"
					width="120"
					height="120"
				/>
				<h5 class="card-subject">{{user.firstname}} {{user.lastname}}</h5>
				<p class="card-text">
					<span><i class="bi bi-patch-check-fill"></i></span> Verified Buyer <i class="fa-solid fa-id-badge fa-lg" style="color: #8cc53f;"></i></i> <br><br>
					You are entitled to discounts as a registered buyer.
				</p>
				<a href="#" class="btn btn-md btn-success">{{user.email}}</a>
				</div>
			</div>
			</div>


			<!-- RIGHT CARD -->
			<div class="col-lg-8 col-md-7 col-sm-12">
				<div class="card" id="profile-card">
					<div class="card-header text-center d-flex justify-content-between align-items-center">
						<strong>Personal Information</strong>
						<button id="editBtn" class="btn btn-outline-secondary btn-sm">Edit</button>
					</div>

					<div class="card-body">
						<form id="profileForm" action="/auth/profile/update" method="POST">
							<div class="row">
								<div class="col">
									<div class="form-group">
										<label>First Name</label>
										<input type="text" name="first_name" class="form-control" value="{{user.firstname}}" disabled>
									</div>
								</div>
								<div class="col">
									<div class="form-group">
										<label>Last Name</label>
										<input type="text" name="last_name" class="form-control" value="{{user.lastname}}" disabled>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col">
									<div class="form-group">
										<label>Username</label>
										<input type="text" name="username" class="form-control" value="{{user.username}}" disabled>
									</div>
								</div>
								<div class="col">
									<div class="form-group">
										<label>Phone Number</label>
										<input type="text" name="phone" class="form-control" value="{{user.phone}}" disabled>
									</div>
								</div>
							</div>

							<div class="form-group">
								<label>Email</label>
								<input type="email" class="form-control" value="{{user.email}}" disabled>
							</div>

							<div class="form-group">
								<label>Contact Address</label>
								<input type="text" name="address" class="form-control" value="{{user.address}}" disabled>
							</div>

							<div class="row">
								<div class="col-md-3">
									<div class="form-group">
									<label>City</label>
									<input type="text" name="city" class="form-control" value="{{user.city}}" disabled>
									</div>
								</div>
								<div class="col-md-3">
									<div class="form-group">
									<label>State</label>
									<input type="text" name="state" class="form-control" value="{{user.state}}" disabled>
									</div>
								</div>
								<div class="col-md-3">
									<div class="form-group">
									<label>Zip Code</label>
									<input type="text" name="zip_code" class="form-control" value="{{user.zip_code}}" disabled>
									</div>
								</div>
								<div class="col-md-3">
									<div class="form-group">
									<label>Country</label>
									<input type="text" name="country" class="form-control" value="{{user.country}}" disabled>
									</div>
								</div>
							</div>
							<button type="submit" class="btn btn-success mt-2" id="saveBtn" disabled>Update</button>
						</form>
					</div>
				</div>	
			</div>
		</div>
	</div>
</section>

<!-- JavaScript to toggle edit mode -->
<script>
	document.getElementById("editBtn").addEventListener("click", function () {
		const form = document.getElementById("profileForm");
		const inputs = form.querySelectorAll("input");
		const saveBtn = document.getElementById("saveBtn");

		const isEditing = inputs[0].disabled === false;

		inputs.forEach(input => {
			if (input.name !== "email") {
				input.disabled = isEditing;
			}
		});
		
		saveBtn.disabled = isEditing;
		this.textContent = isEditing ? "Edit" : "Cancel";
	});
</script>
